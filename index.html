<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">

<title>Let's make a web map, with Mapsense.js</title>

<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
<meta name="author" content="Hakim El Hattab">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

<link rel="stylesheet" href="css/reveal.css">
<link rel="stylesheet" href="css/theme/solarized.css" id="theme">

<!-- Code syntax highlighting -->
<link rel="stylesheet" href="lib/css/solarized_light.css">
    
<style>
      body, html, #myMap {
        height: 100%;
        width: 100%;
        margin: 0;
        border: 1px dotted green;
      } 
    
    #myMap {
        height: 500px;
    }
    
    /* jmk overrides */

    section.liveCoding {
        height: 100%;    
    }
    
    .reveal pre {
        box-shadow: none;
        margin: 0 auto;
        width: 100%;
    }
    
    .reveal pre code {
        display: block;
        padding: 0px;
        overflow: auto;
        word-wrap: normal;
        background: #f8f8f8;
        color: #777;
        max-height: 100%;
        box-shadow: 0px 0px 6px rgba(0, 0, 0, 0.3);
        /*
        position: relative;
        width: 100vw;
        left: calc(-30vw + 50%);
        box-sizing: border-box;

        width: 80vw;
        margin: 0 auto;
        
        position: absolute;
        left: 10px; right: 10px;
        box-shadow: none;
        max-height: 400px;
        background: #3F3F3F;
        color: #DCDCDC;
        */
    }
</style>

<!-- Printing and PDF exports -->
<script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
</script>

<!--[if lt IE 9]>
<script src="lib/js/html5shiv.js"></script>
<![endif]-->
</head>

<body>
<div class="reveal">
<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">
<section>
    <h1>Vector Tiles</h1>
    <p>with</p>
    <h1>Mapsense.js</h1>
    <h3></h3>
    <p>
        <small>John Kelly for Maptime San Francisco</small><br>
        <small><a href="http://twitter.com/MaptimeSF" target="_blank">@MaptimeSF</a> | <a href="http://twitter.com/jhnklly" target="_blank">@jhnklly</a></small>
    </p>
</section>

<section>
    <p>Follow along!</p>
    <p><a href="http://--.github.io/d3-maptime" target="_blank">--.github.io/d3-maptime</a></p>
    <p>Or get the code for examples:</p>
    <p><a href="http://github.com/--/d3-maptime" target="_blank">github.com/--/d3-maptime</a></p>
</section>

<section>
    <h2>Step 5: All Done</h2>
    <iframe></iframe>
</section>

<section>
    <h2>Step 1: Start with boilerplate + libraries</h2>

    <p>Lay down some boilerplate HTML and load the libraries.</p>
    <pre><code>&lt;!doctype html&gt;
&lt;html&gt;
    &lt;head&gt;
        <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
        <script src="http://d3js.org/topojson.v1.min.js" charset="utf-8"></script>
        <script src="https://developer.mapsense.co/mapsense.js" charset="utf-8"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

        <link  type="text/css"  href="https://developer.mapsense.co/mapsense.css" rel="stylesheet"/>
    &lt;/head&gt;
    &lt;body&gt;
        <script>
            // our code will go here
        </script>
    &lt;/body&gt;
&lt;/html&gt;
    </code></pre>
</section>

<section>
    <h2>Step 2: Add a Mapsense basemap</h2>

    <pre><code>
d3.select("body").append("div").attr("id","myMap").attr("style","height: 100%;");

var map = mapsense.map("#myMap")
    .add(mapsense.basemap().apiKey("key-2d5eacd8b924489c8ed5e8418bd883bc"));
    </code></pre>

    <p>Btw: you can get an API key at <a target="_blank" href="https://developer.mapsense.co/account/#signUp">developer.mapsense.co.</a></p>


</section>

<section>
<div class="livecode stretch">
<pre><code class="javascript">(function(){
var the_key = "key-2d5eacd8b924489c8ed5e8418bd883bc";
var map = mapsense.map("#myMap"); 
map.zoom(8).center({lon: -122.3, lat: 37.5});

layer_url = "https://{S}-api.mapsense.co/universes/mapsense.demographics/{Z}/{X}/{Y}.topojson?api-key=" + the_key;
layer_url += "&select=layer,fips_code";
layer_url += "&where=layer=='state'";
//layer_url += "&ringSpan=10&lineSpan=10&s=10"; 

layer = mapsense.topoJson()
    .url(mapsense.url(layer_url).hosts(['a', 'b', 'c', 'd']))
    .clip(true)
    ;

map.add(layer);
// webkit bug: d3.selectAll('clipPath').attr('id','clippr');
d3.selectAll('#org\\.polymaps\\.1').attr('id','clippr');
//d3.selectAll('[clip-path="url(#org.polymaps.1)"]').attr('clip-path','url(http://localhost/htdocs_link/maptime/slide_decks/slides_intro_mapsense/#/5/clippr)');
d3.selectAll('[clip-path="url(#org.polymaps.1)"]').attr('clip-path','url(#clippr)');

})();</code></pre>

<pre><code class="html">
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="http://d3js.org/topojson.v1.min.js" charset="utf-8"></script>
<script src="https://developer.mapsense.co/mapsense.js" charset="utf-8"></script>
<link  type="text/css"  href="https://developer.mapsense.co/mapsense.css" rel="stylesheet"/>
    
&lt;div id="myMap"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<pre><code class="css">
    #myMap { height: 100%; overflow: hidden; }
    path { fill: none; stroke-width: 1; stroke: pink; }
</code></pre>
        
</div>

</section>

</div>
</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="http://d3js.org/topojson.v1.min.js" charset="utf-8"></script>
<script src="https://developer.mapsense.co/mapsense.js" charset="utf-8"></script>
<link  type="text/css"  href="https://developer.mapsense.co/mapsense.css" rel="stylesheet"/>
    
<script>

// Full list of configuration options available at:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
controls: true,
slideNumber: true,
progress: true,
history: true,
center: false,
width: 960,
height: 700,
margin: 0.01,

transition: 'fade', // none/fade/slide/convex/concave/zoom

// Optional reveal.js plugins
dependencies: [
    { src: 'plugin/livecode/livecode.js', async: true },
    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
    { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
    { src: 'plugin/zoom-js/zoom.js', async: true },
    { src: 'plugin/notes/notes.js', async: true },
]
});

</script>

</body>
</html>
